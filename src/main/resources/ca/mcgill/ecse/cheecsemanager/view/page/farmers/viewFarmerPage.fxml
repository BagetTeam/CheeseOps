<?xml version="1.0" encoding="UTF-8" ?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.shape.SVGPath?>
<?import ca.mcgill.ecse.cheecsemanager.fxml.components.*?>
<StackPane
    fx:id="viewFarmerRoot"
    prefHeight="600.0"
    prefWidth="900.0"
    styleClass="page, bg-bg"
    xmlns="http://javafx.com/javafx/21"
    xmlns:fx="http://javafx.com/fxml/1"
    fx:controller="ca.mcgill.ecse.cheecsemanager.fxml.controllers.Farmer.ViewFarmerController"
    alignment="TOP_CENTER"
>
   <VBox maxWidth="832">
      <children>
         <!-- Header -->
         <HBox
                alignment="CENTER_LEFT"
                spacing="12"
                style="-fx-padding: 16; -fx-background-color: transparent;"
            >
            <children>
               <StyledButton
                        fx:id="backBtn"
                        variant="DEFAULT"
                        text=""
                        onAction="#handleBack"
                    >
                  <graphic>
                     <Icon icon="ArrowLeft" />
                  </graphic>
               </StyledButton>
               <Label
                        text="Farmer details"
                        style="-fx-text-fill: -color-fg; -fx-font-size: 18px; -fx-font-weight: bold;"
                    />
            </children>
         </HBox>
         
         <!-- Main content -->
         <HBox spacing="24" VBox.vgrow="ALWAYS">
            <padding>
               <Insets top="16" right="24" bottom="24" left="24" />
            </padding>
            <children>
               <!-- Left Panel - Farmer Details Card -->
               <VBox
                        fx:id="farmerDescriptionCard"
                        alignment="TOP_CENTER"
                        spacing="10"
                        styleClass="farmer-card"
                        prefWidth="300"
                    >
                  <padding>
                     <Insets top="32" right="32" bottom="32" left="32" />
                  </padding>
                  <children>
                     <!-- Profile Image Circle -->
                     <StackPane>
                        <children>
                           <Circle
                                        centerX="60.0"
                                        centerY="60.0"
                                        radius="60.0"
                                        style="-fx-fill: transparent; -fx-stroke: -color-muted; -fx-stroke-width: 2;"
                                    />
                           <SVGPath
                                        content="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
                                        style="-fx-fill: -color-muted;"
                                        layoutX="18"
                                        layoutY="24"
                                        scaleX="3.5"
                                        scaleY="3.5"
                                    />
                        </children>
                     </StackPane>
                     
                     <VBox alignment="TOP_LEFT" maxWidth="Infinity" spacing="4">
                        <Label
                                    fx:id="nameLabel"
                                    styleClass="text-fg, text-bold, text-lg"
                                    wrapText="true"
                                />
                        <Label
                                    fx:id="emailLabel"
                                    styleClass="text-fg"
                                    wrapText="true"
                                /> 
                     </VBox>

                     <VBox alignment="TOP_LEFT" maxWidth="Infinity">
                        <HBox alignment="CENTER_LEFT" spacing="6">
                           <children>
                              <Icon icon="Marker" />
                              <Label
                                            fx:id="addressLabel"
                                            styleClass="text-fg"
                                            wrapText="true"
                                        />
                           </children>
                        </HBox>
                     </VBox>
                     <!-- Action Buttons -->
                     <HBox alignment="CENTER" spacing="12">
                        <VBox.margin>
                           <Insets top="16" />
                        </VBox.margin>
                        <children>
                           <StyledButton
                                        fx:id="editBtn"
                                        variant="DEFAULT"
                                        size="BASE"
                                        text="Edit"
                                        onAction="#handleEdit"
                                    />
                           <StyledButton
                                        fx:id="deleteBtn"
                                        variant="DESTRUCTIVE"
                                        size="BASE"
                                        text="Delete"
                                        onAction="#handleDelete"
                                    />
                        </children>
                     </HBox>
                  </children>
               </VBox>
               
               <!-- Right Panel - Purchases Table -->
               <VBox spacing="16" HBox.hgrow="ALWAYS">
                  <children>
                     <!-- Header with Buy button -->
                     <VBox alignment="CENTER_LEFT" spacing="16">
                        <children>
                           <Label
                                        text="Purchased Cheese Wheels"
                                        style="-fx-text-fill: -color-fg; -fx-font-size: 20px; -fx-font-weight: bold;"
                                        VBox.vgrow="ALWAYS"
                                    />
                           <StyledButton
                                        fx:id="buyBtn"
                                        variant="PRIMARY"
                                        size="SM"
                                        text="Add Purchase"
                                        onAction="#handleBuy"
                                    >
                              <graphic>
                                 <Icon icon="Plus" />
                              </graphic>
                           </StyledButton>
                        </children>
                     </VBox>
                     
                     <!-- Table -->
                     <TableView
                                fx:id="cheeseTable"
                                VBox.vgrow="ALWAYS"
                                styleClass="farmer-table"
                            >
                        <columns>
                           <TableColumn
                                        fx:id="idColumn"
                                        text="#Id"
                                        prefWidth="60"
                                    />
                           <TableColumn
                                        fx:id="ageColumn"
                                        text="Age (month)"
                                        prefWidth="120"
                                    />
                           <TableColumn
                                        fx:id="spoiledColumn"
                                        text="Spoiled"
                                        prefWidth="80"
                                    />
                           <TableColumn
                                        fx:id="dateColumn"
                                        text="Purchase Date"
                                        prefWidth="140"
                                    />
                           <TableColumn
                                        fx:id="actionColumn"
                                        text=""
                                        prefWidth="80"
                                    />
                        </columns>
                        <columnResizePolicy>
                           <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                     </TableView>
                  </children>
               </VBox>
            </children>
         </HBox>
      </children>
   </VBox>
</StackPane>
